---
import { SITE_TITLE, SITE_DESCRIPTION } from '../profile';
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';
import StoryCard from '@components/StoryCard.astro';

const allStories = await getCollection('stories');
const featuredStories = allStories
	.filter(story => story.data.featured)
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const recentStories = allStories
	.filter(story => !story.data.featured)
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 6);
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<div class="hero">
		<p>Welcome to my stories! These are personal accounts I write for fun. Let's call them based on a mostly true story. Enjoy!</p>
	</div>

	<article>

	{featuredStories.length > 0 && (
		<section class="featured-stories">
			<h2>Featured Stories</h2>
			<div class="featured">
				{featuredStories.map((story) => (
					<StoryCard story={story} featured={true} />
				))}
			</div>
		</section>
	)}

	<section class="recent-stories">
		<h2>Recent Stories</h2>
		<div>
			{recentStories.map((story) => (
				<StoryCard story={story} />
			))}
		</div>
		<div class="archive-link">
			<a href="/stories">View All Stories â†’</a>
		</div>
	</section>

</article>

	<style>
		.hero {
			padding: 0 4em;
			font-size: var(--s1);
		}
		
		.archive-link {
			text-align: center;
			margin-top: var(--s3);
		}
		.archive-link a {
			display: inline-block;
			padding: 0.5rem 1rem;
			text-decoration: none;
			color: inherit;
			border: 1px solid var(--color-accent);
			border-radius: 4px;
			transition: all 0.2s;
		}
	</style>
</BaseLayout>
